import{g as b,b as c,h as v,s as o,u as e,j as w,p as _,t as i,I as k,v as I,x as n,z as N,A as y,M as u,O as P,R as z,an as L,ao as r,f as x,ap as B}from"./index-CM96ScbK.js";const C={class:"div-button"},A={__name:"ProfiloGestore",setup(D){const d=w(),f=b(),p=c(),g=async()=>{L(p).then(()=>{d.replace("/login")}).catch(s=>{})},h=async()=>{try{console.log("prima");const s=await r.checkPermissions(),t=await r.requestPermissions();if(console.log("dopo"),t.receive!=="granted"){alert("Le notifiche non sono abilitate. Si prega di attivarle dalle impostazioni."),Capacitor.isNative&&Plugins.Browser.open({url:"app-settings:"});return}await r.register(),r.addListener("pushNotificationReceived",a=>{const l=Math.floor(Date.now()/1e3)+Math.floor(Math.random()*1e3);r.schedule({notifications:[{id:l,title:a.title,body:a.body,schedule:{at:new Date(Date.now()+1e3)},sound:"default"}]})}),r.addListener("pushNotificationActionPerformed",a=>{}),r.addListener("registration",a=>{m(a.value)})}catch(s){console.error("Errore durante la gestione delle notifiche:",s),alert("Si Ã¨ verificato un errore durante la gestione delle notifiche.")}},m=async s=>{try{const t=c().currentUser;if(!t)return;const a=t.uid,l=x(f,"Gestore",a);await B(l,{notificationToken:s},{merge:!0})}catch(t){console.error("Error updating token: ",t)}};return(s,t)=>(_(),v(e(z),null,{default:o(()=>[i(e(N),null,{default:o(()=>[i(e(k),{color:"primary"},{default:o(()=>[i(e(I),null,{default:o(()=>t[0]||(t[0]=[n("Profilo")])),_:1})]),_:1})]),_:1}),i(e(P),null,{default:o(()=>[y("div",C,[i(e(u),{class:"button","router-link":"/cliente/tabs/tab3/visualizzaProfilo","router-direction":"forward"},{default:o(()=>t[1]||(t[1]=[n(" Visualizza profilo ")])),_:1}),i(e(u),{class:"button-notifiche",onClick:h},{default:o(()=>t[2]||(t[2]=[n(" Attiva notifiche ")])),_:1}),i(e(u),{class:"button-logout",onClick:g},{default:o(()=>t[3]||(t[3]=[n("Logout")])),_:1})])]),_:1})]),_:1}))}};export{A as default};
