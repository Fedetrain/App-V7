import{_ as Me,g as Ne,b as Ce,a as we,r as i,o as Ie,h as U,s as l,u as o,j as he,i as ke,a5 as Pe,q as De,k as Ve,w as _e,l as $e,e as Re,m as I,n as E,p,t as a,I as H,v as O,x as u,y as Se,z as j,A as r,E as Be,G as Ue,Y as Ee,U as z,M as c,ab as K,O as Y,L as oe,a0 as h,a1 as k,aq as J,ar as Fe,K as ae,H as Le,B as te,C as xe,F as qe,R as Te,as as Ae,at as le,au as se,av as ie,f as Ge,aw as ne,ap as He,ax as Oe,ay as je}from"./index-CQjVl0ED.js";const Ke={class:"div-foto-nome"},Ye={class:"image-container"},Je=["src"],Qe={class:"description"},We={class:"div-button-home"},Xe={class:"form-container"},Ze={class:"form-container"},eo={class:"add-photo-container"},oo={class:"menu-photos-container"},ao={class:"menu-photos"},to=["src"],lo={__name:"HomeGestore2",setup(so){const Q=Ne(),W=Ce(),y=we(),P=he(),ue=ke();let F;const L=i("Clicca per caricare una nuova foto");let m=i(!1);const D=i("Nome del Negozio"),V=i("CittÃ  del Negozio"),_=i("Via del Negozio"),$=i("Numero di Cellulare"),x=i("path/immagine.jpg"),R=i("Descrizione del Negozio"),S=i(!0);var v=i("");const q=i(!1),b=i(""),M=i(""),X=i(""),N=i(""),C=i(""),B=i("");var T=i();const A=i(!1),g=i([]),re=i(Ae),de=()=>{q.value=!0,b.value=D.value,M.value=_.value,X.value=V.value,N.value=$.value,C.value=R.value},G=()=>{L.value="Clicca per caricare una nuova foto",q.value=!1},f=async(s,e="medium")=>{await(await Pe.create({message:s,duration:2e3,color:e,position:"top",cssClass:"custom-toast",buttons:[{icon:"close",role:"cancel"}]})).present()},ce=async()=>{try{F=await le.getPhoto({resultType:se.Uri,source:ie.Photos,quality:90}),T=F.webPath,L.value="Immagine caricata con successo. Premi il pulsante salva"}catch(s){f("Errore ","danger")}};async function Z(s){return new Promise((e,t)=>{try{fetch(s).then(n=>n.blob()).then(n=>e(n)).catch(n=>t(n))}catch(n){t(n)}})}const ve=async()=>{m.value=!0;var s;const e=t=>t&&t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();try{const t=Ge(Q,"Negozi",v.value),n={nomeNegozio:e(b.value),indirizzoNegozio:e(M.value),cellulareNegozio:N.value,descrizioneNegozio:C.value};if(T.value){const d=I(y,"/images/".concat(t.id)),w=await Z(F.webPath);await ne(d,w).then(io=>{}),s=await E(d)}await He(t,n,{merge:!0}),D.value=b.value,_.value=M.value,V.value=X.value,$.value=N.value,R.value=C.value,T&&(x.value=s),G(),console.log("Modifiche salvate con successo.")}catch(t){f("Errore ","danger"),console.error("Errore durante il salvataggio delle modifiche:",t)}finally{m.value=!1}},fe=()=>{P.push("/gestore/tabs/tab1gestore/inserisciServizi")},me=()=>{P.push("/gestore/tabs/tab1gestore/inserisciferie")},ge=()=>{P.push("/gestore/tabs/tab1gestore/sceltaOrariLavorativi")};async function pe(){try{const s=W.currentUser;let e=De(Ve(Q,"Negozi"),_e("proprietarioUid","==",s==null?void 0:s.uid));const n=(await $e(e)).docs[0].ref,d=await Re(n);if(d.exists()){v.value=d.id,B.value=d.data().categoriaNegozio,ue.dispatch("setIdDocumentNegozioGestore",v.value),D.value=d.data().nomeNegozio||"",V.value=d.data().cittaNegozio||"",_.value=d.data().indirizzoNegozio||"",$.value=d.data().cellulareNegozio||"",R.value=d.data().descrizioneNegozio||"";const w=I(y,"images/".concat(v.value));x.value=await E(w),S.value=!1}else P.push("/registrazione/registrazioneClienteGestore/registrazioneNegozio")}catch(s){f("Errore ","danger")}}Ie(async()=>{const s=W.currentUser;if(S.value=!0,s)try{await pe()}catch(e){f("Errore ","danger")}S.value=!1});const ze=async()=>{A.value=!0;try{const s=I(y,"menuPhotos/".concat(v.value)),e=await Oe(s);g.value=[];for(const t of e.items){const n=await E(t);g.value.push({url:n,fullPath:t.fullPath})}}catch(s){f("Errore ","danger")}},ee=()=>{A.value=!1},ye=async()=>{try{const e=(await le.getPhoto({resultType:se.Uri,source:ie.Photos,quality:90})).webPath;m.value=!0;const t="".concat(Date.now(),".jpg"),n=I(y,"menuPhotos/".concat(v.value,"/").concat(t)),d=await Z(e);await ne(n,d);const w=await E(n);g.value.push({url:w,fullPath:"menuPhotos/".concat(v.value,"/").concat(t)}),m.value=!1}catch(s){f("Errore ","danger"),m.value=!1}},be=async s=>{try{const e=I(y,s.fullPath);await je(e),g.value=g.value.filter(t=>t.fullPath!==s.fullPath)}catch(e){f("Errore ","danger")}};return(s,e)=>(p(),U(o(Te),null,{default:l(()=>[a(o(j),null,{default:l(()=>[a(o(H),{color:"primary"},{default:l(()=>[a(o(O),null,{default:l(()=>e[10]||(e[10]=[u("Home")])),_:1}),a(o(Se),{"is-open":o(m),message:"Please wait...",class:"loading-spinner"},null,8,["is-open"])]),_:1})]),_:1}),a(o(Y),null,{default:l(()=>[r("div",Ke,[r("div",Ye,[r("img",{class:"img",alt:"Immagine del negozio",src:x.value},null,8,Je),Be(a(o(Ee),{class:"progress-bar",type:"indeterminate",color:"primary"},null,512),[[Ue,S.value]])]),r("h1",null,z(D.value),1),r("h3",null,z(_.value)+", "+z(V.value),1),r("h4",null,z($.value),1),r("div",Qe,[e[11]||(e[11]=r("h6",{class:"h6-description"},"Descrizione",-1)),r("p",null,z(R.value),1)])]),r("div",We,[a(o(c),{class:"custom-button",fill:"outline",onClick:e[0]||(e[0]=t=>de())},{default:l(()=>e[12]||(e[12]=[u("Modifica informazioni")])),_:1}),B.value=="Servizi di estetica e bellezza"?(p(),U(o(c),{key:0,class:"custom-button",fill:"outline",onClick:e[1]||(e[1]=t=>fe())},{default:l(()=>e[13]||(e[13]=[u("Modifica servizi")])),_:1})):K("",!0),B.value=="Servizi di estetica e bellezza"?(p(),U(o(c),{key:1,class:"custom-button",fill:"outline",onClick:e[2]||(e[2]=t=>ge())},{default:l(()=>e[14]||(e[14]=[u("Modifica orari lavorativi")])),_:1})):K("",!0),a(o(c),{class:"custom-button",fill:"outline",onClick:e[3]||(e[3]=t=>me())},{default:l(()=>e[15]||(e[15]=[u("Inserisci ferie")])),_:1}),B.value=="Alimentari e cibo"?(p(),U(o(c),{key:2,class:"custom-button",fill:"outline",onClick:e[4]||(e[4]=t=>ze())},{default:l(()=>e[16]||(e[16]=[u(" Carica Foto Menu ")])),_:1})):K("",!0)])]),_:1}),a(o(ae),{"is-open":q.value,onIonModalDidDismiss:G},{default:l(()=>[a(o(j),null,{default:l(()=>[a(o(H),{color:"primary"},{default:l(()=>[a(o(O),null,{default:l(()=>e[17]||(e[17]=[u("Modifica informazioni")])),_:1}),a(o(oe),{slot:"end"},{default:l(()=>[a(o(c),{onClick:G},{default:l(()=>e[18]||(e[18]=[u("Chiudi")])),_:1})]),_:1})]),_:1})]),_:1}),a(o(Y),null,{default:l(()=>[r("div",Xe,[a(o(h),{class:"item"},{default:l(()=>[a(o(k),{position:"stacked"},{default:l(()=>e[19]||(e[19]=[u("Immagine del negozio")])),_:1}),a(o(c),{class:"upload-btn",onClick:e[5]||(e[5]=t=>ce())},{default:l(()=>[u(z(L.value),1)]),_:1})]),_:1}),a(o(h),{class:"item"},{default:l(()=>[a(o(k),{position:"stacked"},{default:l(()=>e[20]||(e[20]=[u("Nome")])),_:1}),a(o(J),{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=t=>b.value=t),class:"input-field"},null,8,["modelValue"])]),_:1}),a(o(h),{class:"item"},{default:l(()=>[a(o(k),{position:"stacked"},{default:l(()=>e[21]||(e[21]=[u("Via")])),_:1}),a(o(J),{modelValue:M.value,"onUpdate:modelValue":e[7]||(e[7]=t=>M.value=t),class:"input-field"},null,8,["modelValue"])]),_:1}),a(o(h),{class:"item"},{default:l(()=>[a(o(k),{position:"stacked"},{default:l(()=>e[22]||(e[22]=[u("Numero di cellulare")])),_:1}),a(o(J),{modelValue:N.value,"onUpdate:modelValue":e[8]||(e[8]=t=>N.value=t),class:"input-field"},null,8,["modelValue"])]),_:1}),a(o(h),{class:"item"},{default:l(()=>[a(o(k),{position:"stacked"},{default:l(()=>e[23]||(e[23]=[u("Descrizione")])),_:1}),a(o(Fe),{modelValue:C.value,"onUpdate:modelValue":e[9]||(e[9]=t=>C.value=t),class:"input-field"},null,8,["modelValue"])]),_:1}),a(o(c),{class:"save-btn",expand:"block",onClick:ve},{default:l(()=>e[24]||(e[24]=[u("Salva modifiche")])),_:1})])]),_:1})]),_:1},8,["is-open"]),a(o(ae),{"is-open":A.value,onIonModalDidDismiss:ee},{default:l(()=>[a(o(j),null,{default:l(()=>[a(o(H),{color:"primary"},{default:l(()=>[a(o(O),null,{default:l(()=>e[25]||(e[25]=[u("Modifica Menu")])),_:1}),a(o(oe),{slot:"end"},{default:l(()=>[a(o(c),{onClick:ee},{default:l(()=>e[26]||(e[26]=[u("Chiudi")])),_:1})]),_:1})]),_:1})]),_:1}),a(o(Y),null,{default:l(()=>[r("div",Ze,[r("div",eo,[a(o(c),{class:"add-photo-btn",fill:"clear",onClick:ye},{default:l(()=>[a(o(Le),{icon:re.value,class:"add-icon"},null,8,["icon"])]),_:1})]),r("div",oo,[r("div",ao,[(p(!0),te(qe,null,xe(g.value,(t,n)=>(p(),te("div",{key:n,class:"menu-photo"},[r("img",{src:t.url,alt:"Foto Menu",class:"img-menu"},null,8,to),a(o(c),{color:"danger",size:"small",onClick:d=>be(t)},{default:l(()=>e[27]||(e[27]=[u("Elimina")])),_:2},1032,["onClick"])]))),128))])])])]),_:1})]),_:1},8,["is-open"])]),_:1}))}},uo=Me(lo,[["__scopeId","data-v-e778b9e1"]]);export{uo as default};
